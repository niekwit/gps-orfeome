$schema: "http://json-schema.org/draft-06/schema#"

description: Snakemake configuration file

type: object

properties:
  bin_number:
    description: Number of bins set during sorting of cells (should be the same for each sample)
    type: integer
    minimum: 1
    default: 1

  cutadapt:
    description: Adapter trimming settings
    type: object
    properties:
      
      five_prime_adapter:
        description: Sequence of an adapter ligated to the 5' end. The adapter and any preceding bases are trimmed.
        type: string
        pattern: "^[ACGTNacgtn]+$"
      
      three_prime_adapter:
        description: Sequence of an adapter ligated to the 3' end. The adapter and subsequent bases are trimmed.
        type: string
        pattern: "^[ACGTNacgtn]+$"

      extra:
        description: Extra cutadapt arguments
        type: string
  
    required:
      - five_prime_adapter
      - three_prime_adapter
      - extra
  
  csv:
    description: CSV file settings
    type: object
    properties:
      
      gene_column:
        description: Column number with gene names
        type: integer
        minimum: 0
      
      orf_column:
        description: Column number with unique ORF names
        type: integer
        minimum: 0
      
      barcode_id_column:
        description: Column number with barcode IDs
        type: integer
        minimum: 0
      
      sequence_column:
        description: Column number with barcode sequences
        type: integer
        minimum: 0

  mismatch:
    description: Mismatches allowed during alignment
    type: integer
    minimum: 0
    maximum: 2
    default: 0
      
  mageck:
    description: MAGeCK settings
    type: object
    properties:
      
      run:
        description: Run MAGeCK analysis
        type: boolean
      
      extra_mageck_arguments:
        description: Extra MAGeCK arguments
        type: string
      
      mageck_control_barcodes:
        description: All or file with control barcodes
        type: string
        enum:
          - all
          - file
      
      fdr:
        description: FDR threshold for downstream mageck analysis
        type: number
        minimum: 0
        maximum: 1
        default: 0.25
  
    required:
      - run
      - extra_mageck_arguments
      - mageck_control_barcodes
      - fdr
  
  drugz:
    description: drugZ settings
    type: object
    properties:
      
      run:
        description: Run drugZ analysis
        type: boolean
      
      extra:
        description: Extra drugZ arguments
        type: string
  
    required:
      - run
      - extra

  psi:
    description: Protein stability analysis settings
    type: object
    properties:
      
      sob_threshold:
        description: Minimum value of sum of barcode counts across all bins to keep
        type: integer
        minimum: 1
      
      hit_threshold:
        description: deltaPSI thresholds for hits
        type: number
        minimum: 0
      
      bc_th:
        description: Barcode threshold for hits
        type: integer
        minimum: 1
      
      correction_factor:
        description: Correction factor for creating a random third barcode for orfs with only two barcodes
        type: number
        minimum: 1
      
      sd_th:
        description: SD threshold for most stringent hits
        type: number
        minimum: 1
      
    required:
      - sob_threshold
      - hit_threshold
      - bc_th
      - correction_factor
      - sd_th